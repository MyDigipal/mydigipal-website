---
import { type Language } from '@/i18n/config';
import Icon from '@/components/ui/Icon.astro';

interface Feature {
  icon?: string;
  title: string;
  description: string;
}

interface Props {
  lang: Language;
  features: Feature[];
  color?: 'seo' | 'ads' | 'social' | 'abm' | 'primary';
}

const { lang, features, color = 'primary' } = Astro.props;

const colorConfig = {
  seo: {
    gradient: 'from-emerald-500 to-teal-600',
    light: 'bg-emerald-50',
    border: 'border-emerald-200 hover:border-emerald-400',
    text: 'text-emerald-600',
    glow: 'hover:shadow-emerald-500/20',
  },
  ads: {
    gradient: 'from-amber-500 to-orange-600',
    light: 'bg-amber-50',
    border: 'border-amber-200 hover:border-amber-400',
    text: 'text-amber-600',
    glow: 'hover:shadow-amber-500/20',
  },
  social: {
    gradient: 'from-violet-500 to-purple-600',
    light: 'bg-violet-50',
    border: 'border-violet-200 hover:border-violet-400',
    text: 'text-violet-600',
    glow: 'hover:shadow-violet-500/20',
  },
  abm: {
    gradient: 'from-pink-500 to-rose-600',
    light: 'bg-pink-50',
    border: 'border-pink-200 hover:border-pink-400',
    text: 'text-pink-600',
    glow: 'hover:shadow-pink-500/20',
  },
  primary: {
    gradient: 'from-blue-500 to-indigo-600',
    light: 'bg-blue-50',
    border: 'border-blue-200 hover:border-blue-400',
    text: 'text-blue-600',
    glow: 'hover:shadow-blue-500/20',
  },
};

const colors = colorConfig[color];

// Card style variations
const cardStyles = [
  'style-gradient',
  'style-bordered',
  'style-dark',
  'style-minimal',
  'style-accent',
  'style-glass',
];

const title = lang === 'fr' ? 'Ce Que Nous Faisons' : 'What We Do';
const subtitle = lang === 'fr'
  ? 'Des solutions complètes pour dominer les résultats de recherche'
  : 'Comprehensive solutions to dominate search results';
---

<section class="py-24 bg-slate-50 overflow-hidden">
  <div class="container-custom">
    <!-- Section Header -->
    <div class="text-center max-w-3xl mx-auto mb-16">
      <span class={`inline-block px-4 py-1 rounded-full text-sm font-medium ${colors.light} ${colors.text} mb-4`}>
        ⚡ {lang === 'fr' ? 'Nos Services' : 'Our Services'}
      </span>
      <h2 class="text-4xl lg:text-5xl font-bold text-slate-900 mb-4">
        {title}
      </h2>
      <p class="text-lg text-slate-600">
        {subtitle}
      </p>
    </div>

    <!-- Features Grid with Varied Styles -->
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
      {features.map((feature, index) => {
        const styleClass = cardStyles[index % cardStyles.length];
        return (
          <div
            class={`feature-card group relative p-8 rounded-3xl transition-all duration-500 ${styleClass}`}
            style={`animation-delay: ${index * 100}ms`}
            data-color={color}
          >
            {/* Different card styles */}
            {styleClass === 'style-gradient' && (
              <div class={`absolute inset-0 bg-gradient-to-br ${colors.gradient} rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500`}></div>
            )}

            <div class="relative z-10">
              {/* Icon */}
              <div class={`
                w-14 h-14 rounded-2xl flex items-center justify-center mb-6 transition-all duration-300
                ${styleClass === 'style-gradient' ? `bg-white/20 group-hover:bg-white/30 ${colors.text} group-hover:text-white` : ''}
                ${styleClass === 'style-bordered' ? `${colors.light} ${colors.text}` : ''}
                ${styleClass === 'style-dark' ? 'bg-slate-800 text-white' : ''}
                ${styleClass === 'style-minimal' ? `${colors.light} ${colors.text}` : ''}
                ${styleClass === 'style-accent' ? `bg-gradient-to-br ${colors.gradient} text-white` : ''}
                ${styleClass === 'style-glass' ? 'bg-white/50 backdrop-blur-sm border border-white/50 ' + colors.text : ''}
                group-hover:scale-110 group-hover:rotate-3
              `}>
                <Icon name={feature.icon || 'zap'} size={28} />
              </div>

              {/* Title */}
              <h3 class={`
                text-xl font-bold mb-3 transition-colors duration-300
                ${styleClass === 'style-gradient' ? 'text-slate-900 group-hover:text-white' : ''}
                ${styleClass === 'style-dark' ? 'text-white' : ''}
                ${styleClass !== 'style-gradient' && styleClass !== 'style-dark' ? 'text-slate-900' : ''}
              `}>
                {feature.title}
              </h3>

              {/* Description */}
              <p class={`
                text-sm leading-relaxed transition-colors duration-300
                ${styleClass === 'style-gradient' ? 'text-slate-600 group-hover:text-white/90' : ''}
                ${styleClass === 'style-dark' ? 'text-slate-300' : ''}
                ${styleClass !== 'style-gradient' && styleClass !== 'style-dark' ? 'text-slate-600' : ''}
              `}>
                {feature.description}
              </p>

              {/* Hover indicator */}
              <div class={`
                mt-6 flex items-center gap-2 text-sm font-medium opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0
                ${styleClass === 'style-gradient' ? 'text-white' : colors.text}
                ${styleClass === 'style-dark' ? 'text-white' : ''}
              `}>
                <span>{lang === 'fr' ? 'En savoir plus' : 'Learn more'}</span>
                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </div>
            </div>

          </div>
        );
      })}
    </div>
  </div>
</section>

<style>
  .feature-card {
    animation: fade-up 0.6s ease forwards;
    opacity: 0;
    transform: translateY(30px);
  }

  @keyframes fade-up {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Card style variations */
  .style-gradient {
    background: white;
    border: 1px solid #e2e8f0;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05);
  }
  .style-gradient:hover {
    border-color: transparent;
    box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.15);
    transform: translateY(-8px) scale(1.02);
  }

  .style-bordered {
    background: white;
    border: 2px solid #e2e8f0;
  }
  .style-bordered:hover {
    border-color: currentColor;
    box-shadow: 0 20px 40px -12px rgb(0 0 0 / 0.1);
    transform: translateY(-4px);
  }

  .style-dark {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border: 1px solid #334155;
  }
  .style-dark:hover {
    box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.4);
    transform: translateY(-8px);
  }

  .style-minimal {
    background: transparent;
    border: 1px dashed #cbd5e1;
  }
  .style-minimal:hover {
    background: white;
    border-style: solid;
    box-shadow: 0 10px 30px -10px rgb(0 0 0 / 0.1);
    transform: translateY(-4px);
  }

  .style-accent {
    background: white;
    border: 1px solid #e2e8f0;
    border-left: 4px solid;
    border-left-color: inherit;
  }
  .style-accent:hover {
    box-shadow: 0 20px 40px -12px rgb(0 0 0 / 0.1);
    transform: translateY(-4px) translateX(4px);
  }

  .style-glass {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.5);
  }
  .style-glass:hover {
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 0 20px 40px -12px rgb(0 0 0 / 0.1);
    transform: translateY(-4px);
  }

  /* Color-specific accent border */
  [data-color="seo"].style-accent { border-left-color: #10B981; }
  [data-color="ads"].style-accent { border-left-color: #F59E0B; }
  [data-color="social"].style-accent { border-left-color: #8B5CF6; }
  [data-color="abm"].style-accent { border-left-color: #EC4899; }
  [data-color="primary"].style-accent { border-left-color: #3B82F6; }
</style>

<script>
  // Intersection Observer for staggered animation
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate');
        }
      });
    },
    { threshold: 0.1 }
  );

  document.querySelectorAll('.feature-card').forEach((card) => {
    observer.observe(card);
  });
</script>
